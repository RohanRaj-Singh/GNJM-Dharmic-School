import{r as h,j as e,L as p,u as f}from"./app-DP1USPyG.js";import{S as b}from"./SimpleLayout-XZui24TN.js";import{u as g}from"./useRoles-DzZ3vsyP.js";function w({students:l=[]}){const[a,o]=h.useState(""),[i,c]=h.useState("gurmukhi"),{isAccountant:u}=g(),r=t=>t?.school_class??t?.schoolClass??null,x=(t,d)=>{const m=String(t??"").trim().toLowerCase();return m?m===d||m.includes(d):!0},n=(l??[]).filter(t=>String(t?.name??"").toLowerCase().includes(a.toLowerCase())).filter(t=>u?(t.enrollments??[]).some(m=>x(r(m)?.type,i)):!0);return e.jsxs(b,{title:"Students",children:[u&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>c("gurmukhi"),className:`px-3 py-1 rounded-full text-sm font-medium border ${i==="gurmukhi"?"bg-blue-600 text-white":"bg-white text-gray-700"}`,children:"Gurmukhi"}),e.jsx("button",{onClick:()=>c("kirtan"),className:`px-3 py-1 rounded-full text-sm font-medium border ${i==="kirtan"?"bg-purple-600 text-white":"bg-white text-gray-700"}`,children:"Kirtan"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{href:"/students/create",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 active:scale-95 transition w-full text-center",children:"+ Add Student"})}),e.jsx("input",{type:"text",placeholder:"Search student...",value:a,onChange:t=>o(t.target.value),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring"}),n.slice().reverse().map(t=>e.jsx(j,{student:t,classFilter:u?i:null},t.id)),n.length===0&&e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No students found"})]})]})}function j({student:l,classFilter:a}){const{isTeacher:o}=g(),{auth:i}=f().props,c=l.enrollments??[],u=o?(i?.user?.sections??[]).map(s=>String(s.id)):null;let r=o?c.filter(s=>u.includes(String(s.section_id))):c;a&&(r=r.filter(s=>{const n=String((s.school_class??s.schoolClass??null)?.type??"").trim().toLowerCase();return n?n===a||n.includes(a):!0}));const x=r.some(s=>s.student_type==="paid");return e.jsxs(p,{href:`/students/${l.id}`,className:"block bg-white rounded-xl shadow p-4 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:l.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Father: ",l.father_name]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${x?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:x?"Paid":"Free"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs",children:[r.map(s=>{const n=s.school_class??s.schoolClass??null,t=s.section??null,d=String(n?.type??"").toLowerCase().includes("kirtan");return e.jsxs("span",{className:`px-2 py-1 rounded-full font-medium ${d?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:[n?.name??"Class"," - ",t?.name??"Section"]},s.id??`${s.class_id}-${s.section_id}-${l.id}`)}),o&&r.length===0&&e.jsx("span",{className:"text-gray-400 italic",children:"No accessible enrollments"})]})]})}export{w as default};
