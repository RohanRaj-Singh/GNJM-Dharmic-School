import{r as d,j as a,a as x}from"./app-Dzq2inqo.js";import{S as E}from"./SimpleLayout-D2_tELxR.js";import R from"./AttendanceMarkPage-DvWa0E7R.js";import v from"./AttendanceSummaryPage-DiK2lOq8.js";function C({section:s,hasAttendanceToday:i,existingAttendance:_=[]}){const m=s.school_class.type==="kirtan",f=t=>({student_id:t.student_section?.student?.id,name:t.student_section?.student?.name??"Unknown",status:t.status??"present",lesson_learned:!!t.lesson_learned}),h=t=>({student_id:t.student.id,name:t.student.name,status:"present",lesson_learned:!1}),u=t=>t.status==="absent"||t.status==="leave"?{...t,lesson_learned:!1}:t,[e,c]=d.useState(()=>i?_.map(f).filter(t=>t.student_id):s.student_sections.map(h)),[l,S]=d.useState(i?"summary":"mark"),[p,g]=d.useState(0),j=t=>{c(r=>r.map((o,n)=>n===p?{...o,...u(t)}:o))},k=(t,r)=>{c(o=>o.map(n=>n.student_id===t?{...n,...u(r)}:n))},y=()=>{x.post("/attendance",{section_id:s.id,attendance:e},{onSuccess:()=>{x.visit("/attendance/sections")}})};return console.log("RECORDS DEBUG",e),a.jsxs(E,{title:"Mark Attendance",children:[a.jsxs("h2",{className:"font-semibold text-gray-800 mb-4 text-center",children:[s.school_class.name," Â· ",s.name]}),e.length===0&&a.jsx("p",{className:"text-center text-gray-500",children:"No students found in this section"}),l==="mark"&&e.length>0&&a.jsx(R,{records:e,index:p,setIndex:g,isKirtan:m,updateCurrent:j,onFinish:()=>S("summary")}),l==="summary"&&e.length>0&&a.jsx(v,{records:e,isKirtan:m,updateRecord:k,onSave:y})]})}export{C as default};
