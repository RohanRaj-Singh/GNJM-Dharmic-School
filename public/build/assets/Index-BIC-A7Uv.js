import{r as x,j as t,L as h,u as f}from"./app-C_YOFr3M.js";import{S as b}from"./SimpleLayout-BqXmp1Tr.js";import{u as p}from"./useRoles-g0KHkJEj.js";const j=s=>s?.school_class??s?.schoolClass??null,m=s=>{const l=String(s?.type??"").trim().toLowerCase(),r=String(s?.name??"").trim().toLowerCase(),n=`${l} ${r}`.trim();return n?n.includes("kirtan")?"kirtan":n.includes("gurmukhi")?"gurmukhi":"":""};function w({students:s=[]}){const[l,r]=x.useState(""),[n,i]=x.useState("gurmukhi"),{isAccountant:o}=p(),c=(s??[]).filter(e=>String(e?.name??"").toLowerCase().includes(l.toLowerCase())).filter(e=>o?(e.enrollments??[]).some(d=>m(j(d))===n):!0);return t.jsxs(b,{title:"Students",children:[o&&t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("button",{onClick:()=>i("gurmukhi"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="gurmukhi"?"bg-blue-600 text-white":"bg-white text-gray-700"}`,children:"Gurmukhi"}),t.jsx("button",{onClick:()=>i("kirtan"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="kirtan"?"bg-purple-600 text-white":"bg-white text-gray-700"}`,children:"Kirtan"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-end",children:t.jsx(h,{href:"/students/create",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 active:scale-95 transition w-full text-center",children:"+ Add Student"})}),t.jsx("input",{type:"text",placeholder:"Search student...",value:l,onChange:e=>r(e.target.value),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring"}),c.slice().reverse().map(e=>t.jsx(y,{student:e,classFilter:o?n:null},e.id)),c.length===0&&t.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No students found"})]})]})}function y({student:s,classFilter:l}){const{isTeacher:r}=p(),{auth:n}=f().props,i=s.enrollments??[],o=r?(n?.user?.sections??[]).map(e=>String(e.id)):null;let a=r?i.filter(e=>o.includes(String(e.section_id))):i;l&&(a=a.filter(e=>{const u=e.school_class??e.schoolClass??null;return m(u)===l}));const c=a.some(e=>e.student_type==="paid");return t.jsxs(h,{href:`/students/${s.id}`,className:"block bg-white rounded-xl shadow p-4 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Father: ",s.father_name]})]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${c?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:c?"Paid":"Free"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs",children:[a.map(e=>{const u=e.school_class??e.schoolClass??null,d=e.section??null,g=m(u)==="kirtan";return t.jsxs("span",{className:`px-2 py-1 rounded-full font-medium ${g?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:[u?.name??"Class"," - ",d?.name??"Section"]},e.id??`${e.class_id}-${e.section_id}-${s.id}`)}),r&&a.length===0&&t.jsx("span",{className:"text-gray-400 italic",children:"No accessible enrollments"})]})]})}export{w as default};
