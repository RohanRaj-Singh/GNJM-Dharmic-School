import{r as l,j as t,a as g}from"./app-DJfHBbO4.js";import{S as _}from"./SimpleLayout-nCTIb97u.js";import{A as C}from"./AttendanceStudentCard-gtU8a64Z.js";import{A as v}from"./AttendanceRecordCard-evwZXabR.js";function L({section:r}){const c=r.school_class.name.toLowerCase()==="kirtan",[a,m]=l.useState(()=>r.student_sections.map(e=>({student_id:e.student.id,name:e.student.name,status:"present",lesson_learned:!1}))),[s,i]=l.useState(0),[u,f]=l.useState("mark"),b=a[s],x=e=>e.status==="absent"||e.status==="leave"?{...e,lesson_learned:!1}:e,p=e=>{m(n=>n.map((o,d)=>d===s?{...o,...x(e)}:o))},h=(e,n)=>{m(o=>o.map(d=>d.student_id===e?{...d,...x(n)}:d))},j=()=>{s<a.length-1?i(e=>e+1):f("summary")},y=()=>{s>0&&i(e=>e-1)},S=()=>{g.post("/attendance",{section_id:r.id,attendance:a},{preserveScroll:!0,onSuccess:()=>{g.visit("/attendance/sections")}})};return t.jsxs(_,{title:"Mark Attendance",children:[t.jsxs("h2",{className:"font-semibold text-gray-800 mb-4 text-center",children:[r.school_class.name," Â· ",r.name]}),u==="mark"&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-sm text-gray-500 text-center mb-4",children:["Student ",s+1," of ",a.length]}),t.jsx(C,{student:b,isKirtan:c,onStatusChange:e=>p({status:e}),onLessonChange:e=>p({lesson_learned:e})}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:y,disabled:s===0,className:"flex-1 py-3 rounded-lg bg-gray-200 text-gray-700 disabled:opacity-50",children:"Previous"}),t.jsx("button",{onClick:j,className:"flex-1 py-3 rounded-lg bg-blue-600 text-white",children:s===a.length-1?"Review Summary":"Next"})]})]}),u==="summary"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-3",children:a.map(e=>t.jsx(v,{name:e.name,status:e.status,lessonLearned:e.lesson_learned,showLesson:c,onStatusChange:n=>h(e.student_id,{status:n}),onLessonChange:n=>h(e.student_id,{lesson_learned:n})},e.student_id))}),t.jsx("button",{onClick:S,className:"w-full bg-green-600 text-white py-3 rounded-lg mt-6",children:"Save Attendance"})]})]})}export{L as default};
