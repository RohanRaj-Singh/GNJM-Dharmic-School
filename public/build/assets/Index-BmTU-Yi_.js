import{r as h,j as e,L as p,u as f}from"./app-BTyKEQgh.js";import{S as b}from"./SimpleLayout-BkCaB_Hr.js";import{u as g}from"./useRoles-n397psr_.js";function N({students:r=[]}){const[a,u]=h.useState(""),[n,c]=h.useState("all"),{isAccountant:d}=g(),i=s=>s?.school_class??s?.schoolClass??null,x=(s,o)=>{const m=String(s??"").trim().toLowerCase();return m?m===o||m.includes(o):!0},l=(r??[]).filter(s=>String(s?.name??"").toLowerCase().includes(a.toLowerCase())).filter(s=>{if(!d)return!0;const o=s.enrollments??[];return n==="all"?o.length>0:o.some(m=>x(i(m)?.type,n))});return e.jsxs(b,{title:"Students",children:[d&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>c("all"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="all"?"bg-slate-700 text-white":"bg-white text-gray-700"}`,children:"All"}),e.jsx("button",{onClick:()=>c("gurmukhi"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="gurmukhi"?"bg-blue-600 text-white":"bg-white text-gray-700"}`,children:"Gurmukhi"}),e.jsx("button",{onClick:()=>c("kirtan"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="kirtan"?"bg-purple-600 text-white":"bg-white text-gray-700"}`,children:"Kirtan"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{href:"/students/create",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 active:scale-95 transition w-full text-center",children:"+ Add Student"})}),e.jsx("input",{type:"text",placeholder:"Search student...",value:a,onChange:s=>u(s.target.value),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring"}),l.slice().reverse().map(s=>e.jsx(y,{student:s,classFilter:d?n:null},s.id)),l.length===0&&e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No students found"})]})]})}function y({student:r,classFilter:a}){const{isTeacher:u}=g(),{auth:n}=f().props,c=r.enrollments??[],d=u?(n?.user?.sections??[]).map(t=>String(t.id)):null;let i=u?c.filter(t=>d.includes(String(t.section_id))):c;a&&a!=="all"&&(i=i.filter(t=>{const l=String((t.school_class??t.schoolClass??null)?.type??"").trim().toLowerCase();return l?l===a||l.includes(a):!0}));const x=i.some(t=>t.student_type==="paid");return e.jsxs(p,{href:`/students/${r.id}`,className:"block bg-white rounded-xl shadow p-4 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:r.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Father: ",r.father_name]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${x?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:x?"Paid":"Free"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs",children:[i.map(t=>{const l=t.school_class??t.schoolClass??null,s=t.section??null,o=String(l?.type??"").toLowerCase().includes("kirtan");return e.jsxs("span",{className:`px-2 py-1 rounded-full font-medium ${o?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:[l?.name??"Class"," - ",s?.name??"Section"]},t.id??`${t.class_id}-${t.section_id}-${r.id}`)}),u&&i.length===0&&e.jsx("span",{className:"text-gray-400 italic",children:"No accessible enrollments"})]})]})}export{N as default};
