import{r as p,j as e,L as g,u as b}from"./app-CTki7zJQ.js";import{S as y}from"./SimpleLayout-DfBoLEm0.js";import{u as f}from"./useRoles-CZWpXxNx.js";function w({students:l=[]}){const[i,u]=p.useState(""),[n,o]=p.useState("all"),{isAccountant:d}=f(),r=s=>s?.school_class??s?.schoolClass??null,m=s=>{const c=String(s?.type??"").trim().toLowerCase(),x=String(s?.name??"").trim().toLowerCase(),h=`${c} ${x}`.trim();return h?h.includes("kirtan")?"kirtan":h.includes("gurmukhi")?"gurmukhi":"":""},a=(l??[]).filter(s=>String(s?.name??"").toLowerCase().includes(i.toLowerCase())).filter(s=>{if(!d)return!0;const c=s.enrollments??[];return n==="all"?c.length>0:c.some(x=>m(r(x))===n)});return e.jsxs(y,{title:"Students",children:[d&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="all"?"bg-slate-700 text-white":"bg-white text-gray-700"}`,children:"All"}),e.jsx("button",{onClick:()=>o("gurmukhi"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="gurmukhi"?"bg-blue-600 text-white":"bg-white text-gray-700"}`,children:"Gurmukhi"}),e.jsx("button",{onClick:()=>o("kirtan"),className:`px-3 py-1 rounded-full text-sm font-medium border ${n==="kirtan"?"bg-purple-600 text-white":"bg-white text-gray-700"}`,children:"Kirtan"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{href:"/students/create",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 active:scale-95 transition w-full text-center",children:"+ Add Student"})}),e.jsx("input",{type:"text",placeholder:"Search student...",value:i,onChange:s=>u(s.target.value),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring"}),a.slice().reverse().map(s=>e.jsx(j,{student:s,classFilter:d?n:null},s.id)),a.length===0&&e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No students found"})]})]})}function j({student:l,classFilter:i}){const{isTeacher:u}=f(),{auth:n}=b().props,o=l.enrollments??[],d=u?(n?.user?.sections??[]).map(t=>String(t.id)):null;let r=u?o.filter(t=>d.includes(String(t.section_id))):o;i&&i!=="all"&&(r=r.filter(t=>{const a=t.school_class??t.schoolClass??null;return classTypeToken(a)===i}));const m=r.some(t=>t.student_type==="paid");return e.jsxs(g,{href:`/students/${l.id}`,className:"block bg-white rounded-xl shadow p-4 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:l.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Father: ",l.father_name]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${m?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:m?"Paid":"Free"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs",children:[r.map(t=>{const a=t.school_class??t.schoolClass??null,s=t.section??null,c=classTypeToken(a)==="kirtan";return e.jsxs("span",{className:`px-2 py-1 rounded-full font-medium ${c?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:[a?.name??"Class"," - ",s?.name??"Section"]},t.id??`${t.class_id}-${t.section_id}-${l.id}`)}),u&&r.length===0&&e.jsx("span",{className:"text-gray-400 italic",children:"No accessible enrollments"})]})]})}export{w as default};
