import{u as m,r as d,j as e,L as x}from"./app-Bx2dRyDp.js";import{S as f}from"./SimpleLayout-BL5fnf_T.js";import{u as p}from"./useRoles-n0qDvg9Z.js";function N({students:n}){console.log(m().props);const[o,c]=d.useState(""),[r,u]=d.useState("gurmukhi"),{isAccountant:a}=p(),l=n.filter(s=>s.name.toLowerCase().includes(o.toLowerCase()));return e.jsxs(f,{title:"Students",children:[a&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>u("gurmukhi"),className:`px-3 py-1 rounded-full text-sm font-medium border
                            ${r==="gurmukhi"?"bg-blue-600 text-white":"bg-white text-gray-700"}`,children:"Gurmukhi"}),e.jsx("button",{onClick:()=>u("kirtan"),className:`px-3 py-1 rounded-full text-sm font-medium border
                            ${r==="kirtan"?"bg-purple-600 text-white":"bg-white text-gray-700"}`,children:"Kirtan"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{href:"/students/create",className:`bg-blue-600 text-white px-4 py-2 rounded-lg
                                   hover:bg-blue-700 active:scale-95 transition
                                   w-full text-center`,children:"+ Add Student"})}),e.jsx("input",{type:"text",placeholder:"Search student...",value:o,onChange:s=>c(s.target.value),className:`w-full border rounded-lg px-3 py-2
                               focus:outline-none focus:ring`}),l.filter(s=>a?(s.enrollments??[]).some(i=>i.school_class?.type===r):!0).slice().reverse().map(s=>e.jsx(g,{student:s,classFilter:a?r:null},s.id)),l.length===0&&e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No students found"})]})]})}function g({student:n,classFilter:o}){const{isTeacher:c}=p(),{auth:r}=m().props,u=n.enrollments??[],a=c?r.user.sections.map(t=>t.id):null;let l=c?u.filter(t=>{const i=a.includes(t.section_id);return console.log("section_id",typeof t.section_id,"allowed",a?.map(h=>typeof h),"isAllowed",i),i}):u;o&&(l=l.filter(t=>t.school_class?.type===o));const s=l.some(t=>t.student_type==="paid");return e.jsxs(x,{href:`/students/${n.id}`,className:`block bg-white rounded-xl shadow p-4
                       active:scale-[0.98] transition
                       focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:n.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Father: ",n.father_name]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${s?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:s?"Paid":"Free"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs",children:[l.map(t=>{const i=t.school_class?.type==="kirtan";return e.jsxs("span",{className:`px-2 py-1 rounded-full font-medium
                                ${i?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:[t.school_class.name," â€” ",t.section.name]},t.id)}),c&&l.length===0&&e.jsx("span",{className:"text-gray-400 italic",children:"No accessible enrollments"})]})]})}export{N as default};
